﻿<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Simon Game</title>
    <script src="Scripts/jquery-1.12.4.min.js"></script>
    <script src="Scripts/jquery-1.12.4.js"></script>
    <script src="Scripts/jquery-1.12.4.intellisense.js"></script>
    <style>
        .gDiv {
            width: 150px;
            height: 150px;
            display: inline-block;
        }

        .red {
            background-color: red;
        }

        .green {
            background-color: green;
        }

        .blue {
            background-color: blue;
        }

        .bluev {
            background-color: blueviolet;
        }

        .opacity {
            opacity: 0.5;
        }

        #onofdiv, #strictdiv {
            background-color: black;
            height: 15px;
            width: 30px;
            padding: 2px;
        }

        #onofswitch, #strictswitch {
            background-color: white;
            height: 15px;
            width: 15px;
            float: left;
        }

        .inline {
            display: inline;
        }

        .clickable {
            pointer-events: auto;
            cursor: pointer;
        }

        .unclickable {
            pointer-events: none;
        }
    </style>
</head>
<body>
    <script>
        var gameConfig = {};
        $(function () {
            gameConfig.starter = function () {
                this.sequence = [];
                this.count = 0;
                this.timeStep = 600;
                gameConfig.lock = false;
            };

            function playPushSound(num) {
                $('#s' + num).get(0).play();
                gameConfig.currPush = $('#' + num);
                gameConfig.currPush.addClass('opacity');
            };
            function playFailSound() {
                $('#s5').get(0).play();
            };

            function addStep() {
                gameConfig.sequence.push(Math.floor(Math.random() * 5));
                gameConfig.toHndl = setTimeout(playSequence, 500);
            }

            function playSequence() {
                var i = 0;
                gameConfig.index = 0;
                gameConfig.seqHndl = setInterval(function () {
                    gameConfig.lock = true;
                    playPushSound(gameConfig.sequence[i]);
                    setTimeout(function () {
                        gameConfig.currPush.removeClass('opacity');
                        i++;
                        if (i === gameConfig.sequence.length) {
                            clearInterval(gameConfig.seqHndl);
                            $('.gDiv').removeClass('unclickable').addClass('clickable');
                            gameConfig.lock = false;
                        }
                    }, 400);
                }, gameConfig.timeStep);
            };

            function pushColor(pushObj) {
                if (!gameConfig.lock) {
                    var pushNr = pushObj.attr('id');

                    gameConfig.pushHndl = setInterval(function () {
                        if (pushNr == gameConfig.sequence[gameConfig.index] && gameConfig.index < gameConfig.sequence.length) {
                            playPushSound(pushNr);
                            setTimeout(function () {
                                gameConfig.currPush.removeClass('opacity');
                                gameConfig.index++;

                                if (gameConfig.index == 20) {
                                    clearInterval(gameConfig.pushHndl)
                                    $('.push').removeClass('clickable').addClass('unclickable');
                                    gameConfig.toHndl = setTimeout(playFailSound(pushObj), gameConfig.timeStep);
                                }
                                else if (gameConfig.index == gameConfig.sequence.length) {
                                    clearInterval(gameConfig.pushHndl)
                                    $('.push').removeClass('clickable').addClass('unclickable');
                                    addStep();
                                }
                            }, 400);
                        }
                        else {
                            $('.push').removeClass('clickable').addClass('unclickable');
                            playFailSound(pushObj);
                        }

                    }, gameConfig.timeStep);
                }
            }




            function gameStart() {
                gameConfig.starter();
                addStep();
            }

            $('#onofswitch').click(function () {
                var x = $(this).css('float');
                if (x == 'left') {
                    $(this).css('float', 'right');
                    isOn = true;
                    $('#onofdiv').css('background-color', 'green');
                }
                else {
                    $(this).css('float', 'left');
                    isOn = false;
                    $('#onofdiv').css('background-color', 'black');
                    $('#strictswitch').css('float', 'left');
                    $('#strictdiv').css('background-color', 'black');
                }
            });
            $('#strictswitch').click(function () {
                var x = $(this).css('float');
                if (!isOn) {
                    return;
                }
                else {
                    if (x == 'left') {
                        $(this).css('float', 'right');
                        isStrict = true;
                        $('#strictdiv').css('background-color', 'green');
                    }
                    else {
                        $(this).css('float', 'left');
                        isStrict = false;
                        $('#strictdiv').css('background-color', 'black');
                    }
                }
            });

            $('.gDiv').click(function () {

                pushColor($(this));

                //var x = $(this).attr('id');
                //playPushSound(x);
                //setTimeout(function () { stopPushSound(x); }, 400);
            });
            $('#stBtn').click(function () { gameStart(); });
        });
    </script>
    <audio id="s1">
        <source src="https://s3.amazonaws.com/freecodecamp/simonSound1.mp3" type="audio/mp3" />
    </audio>
    <audio id="s2">
        <source src="https://s3.amazonaws.com/freecodecamp/simonSound2.mp3 " type="audio/mp3" />
    </audio>
    <audio id="s3">
        <source src="https://s3.amazonaws.com/freecodecamp/simonSound3.mp3" type="audio/mp3" />
    </audio>
    <audio id="s4">
        <source src="https://s3.amazonaws.com/freecodecamp/simonSound4.mp3" type="audio/mp3" />
    </audio>
    <audio id="s5">
        <source src="http://www.pacdv.com/sounds/people_sound_effects/ahhh.mp3" type="audio/mp3" />
    </audio>

    <div id="1" class="gDiv red unclickable"></div>
    <div id="2" class="gDiv green unclickable"></div>
    <div id="3" class="gDiv blue unclickable"></div>
    <div id="4" class="gDiv bluev unclickable"></div>
    <div id="onofdiv">
        <div id="onofswitch" class="inline"></div>
    </div>
    <div id="strictdiv">
        <div id="strictswitch"></div>
    </div>
    <button id="stBtn">Start Game</button>
    <input type="text" id="count" />
</body>
</html>